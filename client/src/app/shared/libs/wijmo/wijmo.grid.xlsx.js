/*
    *
    * Wijmo Library 5.20173.380
    * http://wijmo.com/
    *
    * Copyright(c) GrapeCity, Inc.  All rights reserved.
    *
    * Licensed under the GrapeCity Commercial License.
    * sales@wijmo.com
    * wijmo.com/products/wijmo-5/license/
    *
    */
"use strict";function tryGetModuleWijmoGridDetail(){var e,o;return(e=window.wijmo)&&(o=e.grid)&&o.detail}function tryGetModuleWijmoGridMultirow(){var e,o;return(e=window.wijmo)&&(o=e.grid)&&o.multirow}var __extends=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,o){e.__proto__=o}||function(e,o){for(var r in o)o.hasOwnProperty(r)&&(e[r]=o[r])};return function(o,r){function l(){this.constructor=o}e(o,r),o.prototype=null===r?Object.create(r):(l.prototype=r.prototype,new l)}}();Object.defineProperty(exports,"__esModule",{value:!0});var wjcGrid=require("wijmo/wijmo.grid"),wjcXlsx=require("wijmo/wijmo.xlsx"),wjcCore=require("wijmo/wijmo"),wjcSelf=require("wijmo/wijmo.grid.xlsx");window.wijmo=window.wijmo||{},window.wijmo.grid=window.wijmo.grid||{},window.wijmo.grid.xlsx=wjcSelf;var FlexGridXlsxConverter=function(){function e(){}return e.save=function(e,o,r){var l=this._saveFlexGridToWorkbook(e,o);return r&&l.save(r),l},e.saveAsync=function(e,o,r,l,t){var n=this._saveFlexGridToWorkbook(e,o);return n.saveAsync(r,l,t),n},e.load=function(e,o,r){var l=this;if(o instanceof Blob){var t=new FileReader;t.onload=function(){var o=wjcXlsx.Workbook._base64EncArr(new Uint8Array(t.result)),n=new wjcXlsx.Workbook;n.load(o),o=null,e.deferUpdate(function(){l._loadToFlexGrid(e,n,r),n=null})},t.readAsArrayBuffer(o)}else if(o instanceof wjcXlsx.Workbook)e.deferUpdate(function(){l._loadToFlexGrid(e,o,r),o=null});else{if(o instanceof ArrayBuffer)o=wjcXlsx.Workbook._base64EncArr(new Uint8Array(o));else if(!wjcCore.isString(o))throw"Invalid workbook.";var n=new wjcXlsx.Workbook;n.load(o),o=null,e.deferUpdate(function(){l._loadToFlexGrid(e,n,r),n=null})}},e.loadAsync=function(e,o,r,l,t){var n=this;if(o instanceof Blob){var s=new FileReader;s.onload=function(){var o=wjcXlsx.Workbook._base64EncArr(new Uint8Array(s.result)),i=new wjcXlsx.Workbook;i.loadAsync(o,function(t){o=null,i=null,e.deferUpdate(function(){n._loadToFlexGrid(e,t,r),l&&l(t),t=null})},t)},s.readAsArrayBuffer(o)}else if(o instanceof wjcXlsx.Workbook)e.deferUpdate(function(){n._loadToFlexGrid(e,o,r),l&&l(o),o=null});else{if(o instanceof ArrayBuffer)o=wjcXlsx.Workbook._base64EncArr(new Uint8Array(o));else if(!wjcCore.isString(o))throw"Invalid workbook.";(new wjcXlsx.Workbook).loadAsync(o,function(t){o=null,e.deferUpdate(function(){n._loadToFlexGrid(e,t,r),l&&l(t),t=null})},t)}},e._saveFlexGridToWorkbook=function(e,o){var r,l,t,n,s,i,a,d,c,u,w,f,h,m=new wjcXlsx.Workbook,p=new wjcXlsx.WorkSheet,g=(new wjcXlsx.WorkbookStyle,new wjcXlsx.WorkbookFrozenPane),x=!o||null==o.includeColumnHeaders||o.includeColumnHeaders,y=!(!o||null==o.includeRowHeaders)&&o.includeRowHeaders,j=!o||null==o.includeCellStyles||o.includeCellStyles,b=o?o.activeWorksheet:null,_=o?o.includeColumns:null,C=o?o.formatItem:null,v=0,k=0,S=0,W=0;if(u=e.wj_sheetInfo,p.name=o?o.sheetName:"",p.visible=!o||!1!==o.sheetVisible,u&&u.tableNames&&u.tableNames.length>0)for(var X=0;X<u.tableNames.length;X++)p.tableNames.push(u.tableNames[X]);if(i=[],u||!j&&!C||((w=document.createElement("div")).style.visibility="hidden",w.setAttribute(wjcGrid.FlexGrid._WJS_MEASURE,"true"),e.hostElement.appendChild(w)),y){for(d=0,a=0;a<e.rowHeaders.rows.length;a++)if(!(e.rowHeaders.rows[a].renderSize<=0)){for(i[d]=[],c=0;c<e.rowHeaders.columns.length;c++)t=e._getBindingColumn(e.rowHeaders,a,e.rowHeaders.columns[c]),n=this._getColumnSetting(t,e.columnHeaders.columns.defaultSize),i[d][c]=n,0===d&&((s=new wjcXlsx.WorkbookColumn)._deserialize(n),p._addWorkbookColumn(s,c));d++}W=c}if(x&&e.columnHeaders.rows.length>0){for(d=0,a=0;a<e.columnHeaders.rows.length;a++)if(!(e.columnHeaders.rows[a].renderSize<=0)){for(i[d]||(i[d]=[]),c=0;c<e.columnHeaders.columns.length;c++)t=e._getBindingColumn(e.columnHeaders,a,e.columnHeaders.columns[c]),n=this._getColumnSetting(t,e.columnHeaders.columns.defaultSize),i[d][W+c]=n,0===d&&(_&&!_(t)||((s=new wjcXlsx.WorkbookColumn)._deserialize(n),p._addWorkbookColumn(s)));W=0,r={},l=new wjcXlsx.WorkbookRow,y&&(W=this._parseFlexGridRowToSheetRow(e.topLeftCells,r,a,0,i,j,w,!1,0,_,C)),this._parseFlexGridRowToSheetRow(e.columnHeaders,r,a,W,i,j,w,!1,0,_,C),r.cells.length>0&&(l._deserialize(r),p._addWorkbookRow(l,d)),d++}k=d}else for(i[0]||(i[0]=[]),c=0;c<e.columnHeaders.columns.length;c++)t=e._getBindingColumn(e.columnHeaders,0,e.columnHeaders.columns[c]),n=this._getColumnSetting(t,e.columnHeaders.columns.defaultSize),i[0][W+c]=n,_&&!_(t)||((s=new wjcXlsx.WorkbookColumn)._deserialize(n),p._addWorkbookColumn(s));for(a=0;a<e.cells.rows.length;a++)W=0,r={},l=new wjcXlsx.WorkbookRow,(f=e.rows[a])instanceof wjcGrid._NewRowTemplate||((h=f instanceof wjcGrid.GroupRow)?v=wjcCore.tryCast(f,wjcGrid.GroupRow).level:e.rows.maxGroupLevel>-1&&(v=e.rows.maxGroupLevel+1),y&&(W=this._parseFlexGridRowToSheetRow(e.rowHeaders,r,a,0,i,j,w,h,v,_,C)),this._parseFlexGridRowToSheetRow(e.cells,r,a,W,i,j,w,h,v,_,C),r.cells.length>0&&(l._deserialize(r),p._addWorkbookRow(l,k+a)));for(S=e.cells.rows.length,a=0;a<e.columnFooters.rows.length;a++)W=0,r={},l=new wjcXlsx.WorkbookRow,h=(f=e.columnFooters.rows[a])instanceof wjcGrid.GroupRow,y&&(W=this._parseFlexGridRowToSheetRow(e.rowHeaders,r,a,0,i,j,w,h,0,_,C)),this._parseFlexGridRowToSheetRow(e.columnFooters,r,a,W,i,j,w,h,0,_,C),r.cells.length>0&&(l._deserialize(r),p._addWorkbookRow(l,k+S+a));return g.rows=x?e.frozenRows+k:e.frozenRows,g.columns=y?e.frozenColumns+W:e.frozenColumns,p.frozenPane=g,m._addWorkSheet(p),u||!j&&!C||e.hostElement.removeChild(w),m.activeWorksheet=b,m},e._loadToFlexGrid=function(e,o,r){var l,t,n,s,i,a,d,c,u,w,f,h,m,p,g,x,y,j,b,_,C,v,k,S,W,X,A,G,R,T,F,N,B,H=!r||null==r.includeColumnHeaders||r.includeColumnHeaders,D=!r||null==r.includeColumnHeaders||r.includeColumnHeaders,E=r&&null!=r.sheetIndex&&!isNaN(r.sheetIndex)?r.sheetIndex:0,I=r?r.sheetName:null,z=!r||r.sheetVisible,M=null!=e.wj_sheetInfo,L=0,O=0,P=!1,V={};if(e.itemsSource=null,e.columns.clear(),e.rows.clear(),e.frozenColumns=0,e.frozenRows=0,A={},G={},O=0,s=[],R=[],E<0||E>=o.sheets.length)throw"The sheet index option is out of the sheet range of current workbook.";if(null!=I)for(l=0;l<o.sheets.length;l++)if(I===o.sheets[l].name){h=o.sheets[l];break}if(null!=(h=h||o.sheets[E]).rows){for(H&&(O=1,h.rows.length<=1&&(D=!1,O=0),c=h.rows[0]),p=this._getColumnCount(h.rows),m=this._getRowCount(h.rows,p),b=h.summaryBelow,n=h.columns,L=0;L<p;L++)e.columns.push(new wjcGrid.Column),n[L]&&(isNaN(+n[L].width)||(e.columns[L].width=+n[L].width),n[L].visible||void 0==n[L].visible||(e.columns[L].visible=!!n[L].visible),n[L].style&&n[L].style.wordWrap&&(e.columns[L].wordWrap=n[L].style.wordWrap));for(;O<m;O++){if(g=!1,B=null,f=h.rows[O])for(y=O+1;y<h.rows.length;){if(j=h.rows[y]){(isNaN(f.groupLevel)&&!isNaN(j.groupLevel)||!isNaN(f.groupLevel)&&f.groupLevel<j.groupLevel)&&(g=!0);break}y++}for(g&&!b?(C&&(C.isCollapsed=P),(C=new wjcGrid.GroupRow).isReadOnly=!1,P=null!=f.collapsed&&f.collapsed,C.level=isNaN(f.groupLevel)?0:f.groupLevel,V[C.level]=P,this._checkParentCollapsed(V,C.level)&&C._setFlag(wjcGrid.RowColFlags.ParentCollapsed,!0),e.rows.push(C)):(_=new wjcGrid.Row,f&&this._checkParentCollapsed(V,f.groupLevel)&&_._setFlag(wjcGrid.RowColFlags.ParentCollapsed,!0),e.rows.push(_)),f&&f.height&&!isNaN(f.height)&&(e.rows[D?O-1:O].height=f.height),L=0;L<p;L++)if(f){if(x=f.cells[L],(S=x?x.formula:void 0)&&"="!==S[0]&&(S="="+S),e.setCellData(D?O-1:O,L,S&&M?S:this._getItemValue(x)),g||this._setColumn(s,L,x),W=O*p+L,X=x?x.style:void 0,T=wjcXlsx.Workbook._parseExcelFormat(x),X){if(B=null==B?!!X.wordWrap:B&&!!X.wordWrap,F=this._getItemType(x),X.hAlign)N=wjcXlsx.Workbook._parseHAlignToString(wjcCore.asEnum(X.hAlign,wjcXlsx.HAlign));else switch(F){case wjcCore.DataType.Number:N="right";break;case wjcCore.DataType.Boolean:N="center";break;default:N=T&&0===T.search(/[n,c,p]/i)?"right":"left"}A[W]={fontWeight:X.font&&X.font.bold?"bold":"none",fontStyle:X.font&&X.font.italic?"italic":"none",textDecoration:X.font&&X.font.underline?"underline":"none",textAlign:N,fontFamily:X.font&&X.font.family?X.font.family:"",fontSize:X.font&&X.font.size?X.font.size+"px":"",color:X.font&&X.font.color?X.font.color:"",backgroundColor:X.fill&&X.fill.color?X.fill.color:"",whiteSpace:X.wordWrap?"pre-wrap":"normal",format:T},X.borders&&(X.borders.left&&(this._parseBorderStyle(X.borders.left.style,"Left",A[W]),A[W].borderLeftColor=X.borders.left.color),X.borders.right&&(this._parseBorderStyle(X.borders.right.style,"Right",A[W]),A[W].borderRightColor=X.borders.right.color),X.borders.top&&(this._parseBorderStyle(X.borders.top.style,"Top",A[W]),A[W].borderTopColor=X.borders.top.color),X.borders.bottom&&(this._parseBorderStyle(X.borders.bottom.style,"Bottom",A[W]),A[W].borderBottomColor=X.borders.bottom.color)),X.font&&-1===R.indexOf(X.font.family)&&R.push(X.font.family)}if(x&&wjcCore.isNumber(x.rowSpan)&&x.rowSpan>0&&wjcCore.isNumber(x.colSpan)&&x.colSpan>0&&(x.rowSpan>1||x.colSpan>1))for(l=O;l<O+x.rowSpan;l++)for(t=L;t<L+x.colSpan;t++)G[W=l*p+t]=new wjcGrid.CellRange(O,L,O+x.rowSpan-1,L+x.colSpan-1)}else e.setCellData(D?O-1:O,L,""),this._setColumn(s,L,void 0);f&&(this._checkParentCollapsed(V,f.groupLevel)||f.visible||void 0==f.visible||(e.rows[D?O-1:O].visible=f.visible),e.rows[D?O-1:O].wordWrap=!!f.style&&!!f.style.wordWrap||!!B)}for(C&&(C.isCollapsed=P),h.frozenPane&&(v=h.frozenPane.columns,wjcCore.isNumber(v)&&!isNaN(v)&&(e.frozenColumns=v),k=h.frozenPane.rows,wjcCore.isNumber(k)&&!isNaN(k)&&(e.frozenRows=D&&k>0?k-1:k)),L=0;L<e.columnHeaders.columns.length;L++)i=s[L],(a=e.columns[L]).isRequired=!1,D&&(u=c?c.cells[L]:void 0)&&u.value?(w=wjcXlsx.Workbook._parseExcelFormat(u),d=wjcCore.Globalize.format(u.value,w)):d=this._numAlpha(L),a.header=d,i&&(i.dataType===wjcCore.DataType.Boolean&&(a.dataType=i.dataType),a.format=i.format,a.align=i.hAlign,a.wordWrap=a.wordWrap||!!i.wordWrap);M&&(e.wj_sheetInfo.name=h.name,e.wj_sheetInfo.visible=!0===z||!1!==h.visible,e.wj_sheetInfo.styledCells=A,e.wj_sheetInfo.mergedRanges=G,e.wj_sheetInfo.fonts=R,e.wj_sheetInfo.tableNames=h.tableNames)}},e._parseFlexGridRowToSheetRow=function(e,o,r,l,t,n,s,i,a,d,c){var u,w,f,h,m,p,g,x,y,j,b,_,C,v,k,S,W,X,A,G,R,T,F,N,B,H,D,E=!1;for(W=(u=e.grid).wj_sheetInfo,R=null!=(w=e.rows[r]).recordIndex?w.recordIndex:0,o.cells||(o.cells=[]),o.visible=w.isVisible,o.height=w.renderHeight||e.rows.defaultSize,o.groupLevel=a,i&&(o.collapsed=w.isCollapsed),w.wordWrap&&(o.style={wordWrap:w.wordWrap}),(w.constructor===wjcGrid.Row||w.constructor===wjcGrid._NewRowTemplate||tryGetModuleWijmoGridDetail()&&w.constructor===tryGetModuleWijmoGridDetail().DetailRow||tryGetModuleWijmoGridMultirow()&&w.constructor===tryGetModuleWijmoGridMultirow()._MultiRow)&&(E=!0),h=0;h<e.columns.length;h++)if(m=null,S=1,k=1,D=0,G=!1,C=null,B=null,A=u._getBindingColumn(e,r,e.columns[h]),v=null,W&&e===u.cells?(_=r*e.columns.length+h,W.mergedRanges&&(v=W.mergedRanges[_]),W.styledCells&&(C=W.styledCells[_])):n&&(N=s.cloneNode(),e.hostElement.children.length>0?e.hostElement.children[0].appendChild(N):e.hostElement.appendChild(N),C=(v=u.getMergedRange(e,r,h,!1))?this._getCellStyle(e,N,v.bottomRow,v.rightCol)||{}:this._getCellStyle(e,N,r,h)||{}),v||(v=u.getMergedRange(e,r,h,!1)),v?r===v.topRow&&h===v.leftCol&&(k=v.bottomRow-v.topRow+1,S=this._getColSpan(e,v,d),G=!0):G=!0,!d||d(A)){if(f=t[R][h+l],E||i?(g=G?e.getCellData(r,h,!0):null,x=G?e.getCellData(r,h,!1):null,j=!1,g&&wjcCore.isString(g)&&g.length>1&&"="===g[0]&&(j=!0),X=wjcCore.isDate(x),C&&C.format?(m=C.format,p=wjcXlsx.Workbook._parseCellFormat(C.format,X)):f&&f.style&&f.style.format?(m=A.format,p=f.style.format):p=null,p||(X?p="m/d/yyyy":wjcCore.isNumber(x)&&!A.dataMap?p=wjcCore.isInt(x)?"#,##0":"#,##0.00":j?(b=g.toLowerCase()).indexOf("now()")>-1?(p="m/d/yyyy h:mm",X=!0):b.indexOf("today()")>-1||b.indexOf("date(")>-1?(p="m/d/yyyy",X=!0):b.indexOf("time(")>-1&&(p="h:mm AM/PM",X=!0):p="General")):(g=G?u.columnHeaders.getCellData(0,h,!0):null,p="General"),B=this._parseCellStyle(C)||{},e===u.cells&&i&&w.hasChildren&&h===u.columns.firstVisibleIndex){if(g?y=g:G&&(y=w.getGroupHeader().replace(/<\/?\w+>/g,"")),null==y&&!C)continue;!(X=wjcCore.isDate(y))&&m&&"d"===m.toLowerCase()&&wjcCore.isInt(y)&&(p="0"),y="string"==typeof y?wjcXlsx.Workbook._unescapeXML(y):y,h===u.columns.firstVisibleIndex&&u.treeIndent&&(D=a),T={value:y,isDate:X,formula:j?this._parseToExcelFormula(g,X):null,colSpan:S,rowSpan:k,style:this._extend(B,{format:p,font:{bold:!0},hAlign:wjcXlsx.HAlign.Left,indent:D})}}else g="string"==typeof g?wjcXlsx.Workbook._unescapeXML(g):g,x="string"==typeof x?wjcXlsx.Workbook._unescapeXML(x):x,!X&&m&&"d"===m.toLowerCase()&&wjcCore.isInt(x)&&(p="0"),H=B&&B.hAlign?B.hAlign:f&&f.style&&null!=f.style.hAlign?wjcCore.asEnum(f.style.hAlign,wjcXlsx.HAlign,!0):wjcCore.isDate(x)?wjcXlsx.HAlign.Left:wjcXlsx.HAlign.General,h!==u.columns.firstVisibleIndex||!u.treeIndent||H!==wjcXlsx.HAlign.Left&&H!==wjcXlsx.HAlign.General||(D=a),T={value:j?null:"General"===p?wjcCore.isString(g)?g.replace(/^(\')(\s*=)/,"$2"):g:x,isDate:X,formula:j?this._parseToExcelFormula(g,X):null,colSpan:h<u.columns.firstVisibleIndex?1:S,rowSpan:k,style:this._extend(B,{format:p,hAlign:H,vAlign:k>1?e===u.cells||!1===u.centerHeadersVertically?wjcXlsx.VAlign.Top:wjcXlsx.VAlign.Center:null,indent:D})};c&&(c(F=new XlsxFormatItemEventArgs(e,new wjcGrid.CellRange(r,h),N,s,T)),N=F.cell),N&&(N.parentElement.removeChild(N),N=null),o.cells.push(T)}return l+h},e._parseCellStyle=function(e,o){if(void 0===o&&(o=!1),null==e)return null;var r=e.fontSize;r=r?+r.substring(0,r.indexOf("px")):null,isNaN(r)&&(r=null);var l=e.fontWeight;l="bold"===l||+l>=700;var t="italic"===e.fontStyle,n=e.textDecorationStyle;null==n&&(n=e.textDecoration),n="underline"===n;var s=e.whiteSpace;return s=!!s&&s.indexOf("pre")>-1,{font:{bold:l,italic:t,underline:n,family:this._parseToExcelFontFamily(e.fontFamily),size:r,color:e.color},fill:{color:e.backgroundColor},borders:this._parseBorder(e,o),hAlign:wjcXlsx.Workbook._parseStringToHAlign(e.textAlign),wordWrap:s}},e._parseBorder=function(e,o){var r={};return r.left=this._parseEgdeBorder(e,"Left"),r.right=this._parseEgdeBorder(e,"Right"),r.top=this._parseEgdeBorder(e,"Top"),r.bottom=this._parseEgdeBorder(e,"Bottom"),o&&(r.vertical=this._parseEgdeBorder(e,"Vertical"),r.horizontal=this._parseEgdeBorder(e,"Horizontal")),r},e._parseEgdeBorder=function(e,o){var r,l=e["border"+o+"Style"],t=e["border"+o+"Width"];if(t&&t.length>2&&(t=+t.substring(0,t.length-2)),l&&"none"!==l&&"hidden"!==l){switch(r={},l=l.toLowerCase()){case"dotted":r.style=t>1?wjcXlsx.BorderStyle.MediumDashDotted:wjcXlsx.BorderStyle.Dotted;break;case"dashed":r.style=t>1?wjcXlsx.BorderStyle.MediumDashed:wjcXlsx.BorderStyle.Dashed;break;case"double":r.style=wjcXlsx.BorderStyle.Double;break;default:r.style=t>2?wjcXlsx.BorderStyle.Thick:t>1?wjcXlsx.BorderStyle.Medium:wjcXlsx.BorderStyle.Thin}r.color=e["border"+o+"Color"]}return r},e._parseBorderStyle=function(e,o,r){var l="border"+o+"Style",t="border"+o+"Width";switch(e){case wjcXlsx.BorderStyle.Dotted:case wjcXlsx.BorderStyle.Hair:r[l]="dotted",r[t]="1px";break;case wjcXlsx.BorderStyle.Dashed:case wjcXlsx.BorderStyle.ThinDashDotDotted:case wjcXlsx.BorderStyle.ThinDashDotted:r[l]="dashed",r[t]="1px";break;case wjcXlsx.BorderStyle.MediumDashed:case wjcXlsx.BorderStyle.MediumDashDotDotted:case wjcXlsx.BorderStyle.MediumDashDotted:case wjcXlsx.BorderStyle.SlantedMediumDashDotted:r[l]="dashed",r[t]="2px";break;case wjcXlsx.BorderStyle.Double:r[l]="double",r[t]="3px";break;case wjcXlsx.BorderStyle.Medium:r[l]="solid",r[t]="2px";break;default:r[l]="solid",r[t]="1px"}},e._parseToExcelFontFamily=function(e){var o;return e&&(o=e.split(","))&&o.length>0&&(e=o[0].replace(/\"|\'/g,"")),e},e._parseToExcelFormula=function(e,o){var r,l,t,n,s,i,a,d=/(floor|ceiling)\([+-]?\d+\.?\d*\)/gi,c=/text\(\"?\w+\"?\s*\,\s*\"\w+\"\)/gi,u=/\"?\w+\"?\s*\,\s*\"(\w+)\"/i;if(r=e.match(d))for(s=0;s<r.length;s++)a=(i=r[s]).substring(0,i.lastIndexOf(")"))+", 1)",e=e.replace(i,a);if(r=null,r=e.match(c))for(s=0;s<r.length;s++)(l=(i=r[s]).match(u))&&2===l.length&&(t=l[1],/^d{1,4}?$/.test(t)||(n=wjcXlsx.Workbook._parseCellFormat(t,o),a=i.replace(t,n),e=e.replace(i,a)));return e},e._getColumnSetting=function(e,o){var r=e.renderWidth;return r=r||o,{autoWidth:!0,width:r,visible:e.visible,style:{format:e.format?wjcXlsx.Workbook._parseCellFormat(e.format,e.dataType===wjcCore.DataType.Date):"",hAlign:wjcXlsx.Workbook._parseStringToHAlign(this._toExcelHAlign(e.getAlignment())),wordWrap:e.wordWrap}}},e._toExcelHAlign=function(e){return(e=e?e.trim().toLowerCase():e)?e.indexOf("center")>-1?"center":e.indexOf("right")>-1||e.indexOf("end")>-1?"right":e.indexOf("justify")>-1?"justify":"left":e},e._getColumnCount=function(e){for(var o,r=0,l=0,t=0;t<e.length;t++)(o=e[t]&&e[t].cells?e[t].cells:[])&&o.length>0&&(l=o.length,wjcCore.isInt(o[l-1].colSpan)&&o[l-1].colSpan>1&&(l=l+o[l-1].colSpan-1),l>r&&(r=l));return r},e._getRowCount=function(e,o){for(var r,l,t,n=e.length,s=n-1,i=0;i<o;i++)e:for(;s>=0;s--)if(r=e[s],l=r&&r.cells?r.cells:[],(t=l[i])&&(null!=t.value&&""!==t.value||wjcCore.isInt(t.rowSpan)&&t.rowSpan>1)){wjcCore.isInt(t.rowSpan)&&t.rowSpan>1&&s+t.rowSpan>n&&(n=s+t.rowSpan);break e}return n},e._numAlpha=function(e){var o=Math.floor(e/26)-1;return(o>-1?this._numAlpha(o):"")+String.fromCharCode(65+e%26)},e._getItemType=function(e){if(void 0!==e&&null!==e&&void 0!==e.value&&null!==e.value&&!isNaN(e.value))return wjcCore.getType(e.value)},e._setColumn=function(e,o,r){var l,t,n,s=e[o];s?(l=this._getItemType(r),s.dataType!==l&&s.dataType===wjcCore.DataType.Boolean&&l!==wjcCore.DataType.Boolean&&(s.dataType=l),r&&null!=r.value&&""!==r.value&&(t=wjcXlsx.Workbook._parseExcelFormat(r))&&s.format!==t&&"General"!==t&&(s.format=t),r&&r.style&&(r.style.hAlign&&(n=wjcXlsx.Workbook._parseHAlignToString(wjcCore.asEnum(r.style.hAlign,wjcXlsx.HAlign))),null==s.wordWrap?s.wordWrap=!!r.style.wordWrap:s.wordWrap=s.wordWrap&&!!r.style.wordWrap),n||l!==wjcCore.DataType.Number||(n="right"),s.hAlign=n):e[o]={dataType:this._getItemType(r),format:wjcXlsx.Workbook._parseExcelFormat(r),hAlign:"",wordWrap:null}},e._getItemValue=function(e){if(void 0!==e&&null!==e&&void 0!==e.value&&null!==e.value){var o=e.value;return wjcCore.isNumber(o)&&isNaN(o)?"":o instanceof Date&&isNaN(o.getTime())?"":o}},e._getCellStyle=function(e,o,r,l){try{e.grid.cellFactory.updateCell(e,r,l,o),o.className=o.className.replace("wj-state-selected",""),o.className=o.className.replace("wj-state-multi-selected","")}catch(e){return null}return window.getComputedStyle(o)},e._extend=function(e,o){for(var r in o){var l=o[r];wjcCore.isObject(l)&&e[r]?wjcCore.copy(e[r],l):e[r]=l}return e},e._checkParentCollapsed=function(e,o){var r=!1;return Object.keys(e).forEach(function(l){!0===e[l]&&!1===r&&!isNaN(o)&&+l<o&&(r=!0)}),r},e._getColSpan=function(e,o,r){for(var l=0,t=o.leftCol;t<=o.rightCol;t++)r&&!r(e.columns[t])||l++;return l},e}();exports.FlexGridXlsxConverter=FlexGridXlsxConverter;var XlsxFormatItemEventArgs=function(e){function o(o,r,l,t,n){var s=e.call(this,o,r)||this;return s._cell=l,s._patternCell=t,s._xlsxCell=n,s}return __extends(o,e),Object.defineProperty(o.prototype,"cell",{get:function(){return this._cell},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"xlsxCell",{get:function(){return this._xlsxCell},set:function(e){this._xlsxCell=e},enumerable:!0,configurable:!0}),o.prototype.getFormattedCell=function(){return this._cell||(this._cell=this._patternCell.cloneNode(),this.panel.hostElement.children[0].appendChild(this._cell),FlexGridXlsxConverter._getCellStyle(this.panel,this._cell,this.range.row,this.range.col)),this._cell},o}(wjcGrid.CellRangeEventArgs);exports.XlsxFormatItemEventArgs=XlsxFormatItemEventArgs;